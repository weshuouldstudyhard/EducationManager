(function(a){a.bookshelfSlider=function(b,c){function v(){var b=a("#products_box_"+o+" .product:first-child");var c=b.offset().top;var d=e.offset().top;if(c+143>d){t.css("opacity",.3)}if(c<d){return true}else{return false}}function u(){var b=a("#products_box_"+o+" .product:last-child");var c=b.height()+b.offset().top;var d=e.height()+e.offset().top;if(c-143<d){s.css("opacity",.3)}if(c>d){return true}else{return false}}if(c){a.extend(a.bookshelfSlider.config,c)}var d=a.bookshelfSlider.config;var e=a(".panel_slider");var f=a("#arrow_menu");var g=a(".slide_animate");var h=a(".button_bar");if(a.browser.msie&&parseInt(a.browser.version)==7){var i=true}if(a.browser.msie&&parseInt(a.browser.version)==8){var j=true}e.width(d.item_width);e.height(d.item_height);g.width(d.item_width);g.height(d.item_height+1500);h.css("margin-left",d.buttons_margin);a(".panel_bar").width(d.item_width);a(".panel_title").width(d.item_width);a(".product").css("margin-right",d.product_margin);var k=parseInt(h.css("margin-left"));var l=a("#btn1").position().left+k+a("#btn1").width()/2-10;f.css("left",l);f.show();a(".panel_items").css("width","99999");if(d.show_selected_title){a("#selected_title_box").show();a("#selected_title").text(a("#btn1").text())}a(".products_box").css("margin-left",d.products_box_margin_left);a(".product").each(function(b){var c=a(this);if(c.attr("title")!=""&&c.attr("title")!="undefined"){var e=true}else{var e=false}var f=c.children("img");b++;if(e&&d.product_show_title){c.append("<div class='product_title' id='title_"+b+"'><p>"+c.attr("title")+"</p></div>");var g=a("#title_"+b);var h=f.height()-a(g).height()/2;g.css({left:(c.width()-g.width()-6)/2,top:h});g.css({color:d.product_title_textcolor,background:d.product_title_bgcolor+" url(assets/title_product_bg.png) repeat"})}c.mouseenter(function(){a(g).css({overflow:"visible","max-height":80});a("#i_zoom_"+b).css({"background-position":"-24px 0"});a("#i_play_"+b).css({"background-position":"-72px 0"});a("#i_link_"+b).css({"background-position":"-120px 0"});a("#i_iframe_"+b).css({"background-position":"-168px 0"})}).mouseleave(function(){a(g).css({overflow:"hidden","max-height":11});a("#i_zoom_"+b).css({"background-position":"0 0"});a("#i_play_"+b).css({"background-position":"-48px 0"});a("#i_link_"+b).css({"background-position":"-96px 0"});a("#i_iframe_"+b).css({"background-position":"-144px 0"})});c.children("img").addClass("img_thumb");var j=c.attr("data-type");if(j=="book"){c.append("<img class='fx_book' id='b_"+b+"' + src='assets/book_fx.png' />");if(i){a("#b_"+b).css({height:f.height()+4,top:c.height()-f.height()-4})}else{a("#b_"+b).css({height:f.height(),top:c.height()-f.height()})}}else if(j=="magazine"){c.append("<img class='fx_magazine' id='m_"+b+"' + src='assets/magazine_fx.png' />");if(i){a("#m_"+b).css({height:f.height()+4,top:c.height()-f.height()-4})}else{a("#m_"+b).css({height:f.height(),top:c.height()-f.height()})}}else if(j=="cd"){c.append("<img class='fx_cd' id='cd_"+b+"' + src='assets/cd_fx.png' />");if(i){a("#cd_"+b).css({height:f.height()+4,top:c.height()-f.height()-4})}else{a("#cd_"+b).css({height:f.height(),top:c.height()-f.height()})}}else if(j=="dvd"){c.append("<img class='fx_cd' id='dvd_"+b+"' + src='assets/dvd_fx.png' />");if(i){a("#dvd_"+b).css({height:f.height()+4,top:c.height()-f.height()-4})}else{a("#dvd_"+b).css({height:f.height(),top:c.height()-f.height()})}}c.append("<img class='fx_shadow' id='shd_"+b+"' + src='assets/shadow_fx.png' />");if(d.show_icons){var k=c.attr("data-url");var l=c.attr("data-popup");if(k!=undefined){var m=i?2:0;if(l=="true"&&(k.indexOf(".jpg")!=-1||k.indexOf(".gif")!=-1||k.indexOf(".png")!=-1)){c.append("<div class='icons_sprite' id='i_zoom_"+b+"'></div>");var n=a("#i_zoom_"+b);n.css({"background-position":"0 0",left:(f.width()-n.width())/2+m,top:c.height()-f.height()/2-n.height()/2-m,opacity:1})}else if(l=="true"&&(k.indexOf("youtube.com")!=-1||k.indexOf("vimeo.com")!=-1)){c.append("<div class='icons_sprite' id='i_play_"+b+"'></div>");var o=a("#i_play_"+b);o.css({"background-position":"-48px 0",left:(f.width()-o.width())/2+m,top:c.height()-f.height()/2-o.height()/2-m,opacity:1})}else if(l=="true"&&k!=""&&k!=undefined){c.append("<div class='icons_sprite' id='i_iframe_"+b+"'></div>");var p=a("#i_iframe_"+b);p.css({"background-position":"-144px 0",left:(f.width()-p.width())/2+m,top:c.height()-f.height()/2-p.height()/2-m,opacity:1})}else if(k!=""&&k!=undefined){c.append("<div class='icons_sprite' id='i_link_"+b+"'></div>");var q=a("#i_link_"+b);q.css({"background-position":"-96px 0",left:(f.width()-q.width())/2+m,top:c.height()-f.height()/2-q.height()/2-m,opacity:1})}}}if(c.height()!=f.height()){var r=c.height()-f.height();if(i){f.css("top",r-4);a("#shd_"+b).css({height:f.height()+4,left:f.width()+4,top:r-4})}else{f.css("top",r);a("#shd_"+b).css({height:f.height(),left:f.width(),top:r})}if(e&&d.product_show_title){a(g).css("top",c.height()-a(g).height()/2)}}});var m=0;var n=0;h.click(function(b){b.preventDefault();var c=a(this);if(o-1==c.index())return false;if(parseInt(g.css("top"))!=0){g.animate({top:0,opacity:1},{duration:300})}var e=c.attr("id");var h=a("#"+e);var i=h.position();var j=h.width();var l=i.left+k+j/2-10;f.animate({left:l},{duration:d.arrow_duration,easing:d.arrow_easing,complete:function(){if(d.show_selected_title)a("#selected_title").text(h.text())}});n=d.item_width*c.index();m=-n;g.animate({left:m,top:0},{duration:d.slide_duration,easing:d.slide_easing,complete:function(){}});p=0;s.css("opacity",.3);t.css("opacity",.3);o=c.index()+1;if(q[0]==undefined){a(g).each(function(a){q[a]=u();o++});o=c.index()+1}if(q[c.index()]){s.css("opacity",1);r.show();r.fadeTo("normal",1);a(".panel_slider").mouseenter(function(){r.show();r.fadeTo("normal",1)}).mouseleave(function(){r.hide()})}else{r.hide()}});var o=0;var p=0;var q=[];a(".panel_slider").append("<div id='more_minus_box'><input type='button' id='icon_minus' /><input type='button' id='icon_more' /></div>");var r=a("#more_minus_box");var s=a("#icon_more");var t=a("#icon_minus");t.click(function(b){if(t.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=v();if(!c){return}p-=143;s.css("opacity",1);g.animate({left:m,top:-p},{duration:d.slide_duration/2,easing:d.slide_easing,complete:function(){t.removeAttr("disabled")}})});s.click(function(b){if(s.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=u();if(!c){return}p+=143;t.css("opacity",1);g.animate({left:m,top:-p},{duration:d.slide_duration/2,easing:d.slide_easing,complete:function(){s.removeAttr("disabled")}})});a("#show_hide_titles").click(function(b){b.preventDefault();if(a(".product_title").css("opacity")==1){a(".product_title").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(".product_title").stop().animate({opacity:1},400);a(this).css({opacity:1})}});a("#show_hide_icons").click(function(b){b.preventDefault();if(a(".icons_sprite").css("opacity")==1){a(".icons_sprite").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(".icons_sprite").stop().animate({opacity:1},400);a(this).css({opacity:1})}});a(".product").click(function(b){function A(b,c,e,f){var g=a("#popup_info");g.delay(100).animate({top:l/2-g.height()/2,left:k/2-g.width()/2},400,function(){a("#preload_icon").remove()});var h=k/2-b/2;var i=l/2-c/2;g.delay(100).animate({height:c,width:b,top:i,left:h},400,function(){g.append(e);a(e).fadeIn(600);if(a(f).attr("title")!=""&&a(f).attr("title")!="undefined"&&d.show_title_in_popup){var c=a(f).attr("title");g.append("<div id='popup_title'>"+c+"</div>");var h=parseInt(g.css("padding-left"));a("#popup_title").css({width:b+h*2,top:-(h*2),left:0})}})}b.preventDefault();var c=a(this);var e=c.attr("data-url");var f=c.attr("data-popup");if(f!="true"){if(e==undefined||e==""){return}else{location.href=e;return}}if(f=="true"&&(e==undefined||e==""))return;a("body").append('<div id="mask_popup"></div>');a("body").append('<div id="popup_info"></div>');a("#popup_info").append("<img id='preload_icon' src='assets/preload.gif' />");var g=a("#mask_popup");var h=a("#popup_info");var k=a(window).width();var l=a(window).height();var m=a(document).height();g.css({width:k,height:m});g.fadeIn(400);g.fadeTo("normal",.7);h.css({top:l/2-h.height()/2,left:k/2-h.width()/2});var n=e.indexOf(".jpg")!=-1||e.indexOf(".gif")!=-1||e.indexOf(".png")!=-1?true:false;var o=e.indexOf("youtube.com")!=-1?true:false;var p=e.indexOf("vimeo.com")!=-1?true:false;var q=e.indexOf(".jpg")==-1&&e.indexOf(".gif")==-1&&e.indexOf(".png")==-1&&!p&&!o?true:false;if(n){var r=c;if(i||j){var s=a("<img />").attr("src",e+"?"+(new Date).getTime())}else{var s=a("<img />").attr("src",e)}s.load(function(){A(this.width,this.height,s,r);a(s).hide()})}else if(o){var t=e.split("?v=");var u="?autohide=2&autoplay=1&controls=1&disablekb=0&fs=1&hd=0&loop=0&rel=1&showinfo=0&showsearch=1&wmode=transparent&enablejsapi=1";var v='<iframe class="video_player" width="'+d.video_width_height[0]+'" height="'+d.video_width_height[1]+'" frameborder="0" src="http://www.youtube.com/embed/'+t[1]+u+'"></iframe>';A(d.video_width_height[0],d.video_width_height[1],v,c)}else if(p){var t=e.split("/").pop();var v='<iframe class="video_player" src="http://player.vimeo.com/video/'+t+'?title=0&byline=0&portrait=0&autoplay=1" width="'+d.video_width_height[0]+'" height="'+d.video_width_height[1]+'" frameborder="0"></iframe>';A(d.video_width_height[0],d.video_width_height[1],v,c)}else if(q){if(e.indexOf("?")!=-1){var w=e.split("?size=").pop().split("&");var x=w[0].split("x");var y=parseInt(x[0]),z=parseInt(x[1])}else{var y=d.iframe_width_height[0],z=d.iframe_width_height[1]}var v='<iframe id="iframe_content" src="'+e+'" width="'+y+'" height="'+z+'" frameborder="0"></iframe>';A(y,z,v,c)}a("#mask_popup").click(function(){a(this).hide();a("#popup_info").remove()})});a("#btn1").trigger("click");return this};a.bookshelfSlider.config={item_width:355,item_height:320,products_box_margin_left:20,product_title_textcolor:"#ffffff",product_title_bgcolor:"#c33b4e",product_margin:30,product_show_title:true,show_title_in_popup:true,show_selected_title:true,show_icons:true,buttons_margin:10,slide_duration:1e3,slide_easing:"easeInOutExpo",arrow_duration:800,arrow_easing:"easeInOutExpo",video_width_height:[500,290],iframe_width_height:[400,300]}})(jQuery)